---
permalink: protect-hana/task_clone_a_sap_hana_database_backup.html 
sidebar: sidebar 
keywords: SnapCenter Plug-in for SAP HANA Database,run as 
summary: Puede utilizar SnapCenter para clonar una copia de seguridad.  Puede clonar desde una copia de seguridad primaria o secundaria. 
---
= Clonar una copia de seguridad de la base de datos de SAP HANA
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Puede utilizar SnapCenter para clonar una copia de seguridad.  Puede clonar desde una copia de seguridad primaria o secundaria.

.Antes de empezar
* Deberías haber realizado una copia de seguridad de los recursos o del grupo de recursos.
* Debe asegurarse de que los agregados que alojan los volúmenes estén en la lista de agregados asignados de la máquina virtual de almacenamiento (SVM).
* No se pueden clonar copias de seguridad basadas en archivos.
* El servidor clon de destino debe tener el mismo SID de instancia de SAP HANA que se proporciona en el campo SID del clon de destino.
* Para los comandos previos o posteriores a la clonación, debe verificar si los comandos existen en la lista de comandos disponible en el host del complemento desde las siguientes rutas:
+
** Para Windows: _C:\Archivos de programa\ NetApp\ SnapCenter\Snapcenter Plug-in Creator\etc\allowed_commands.config_
** Para Linux: _/opt/ NetApp/snapcenter/scc/etc/allowed_commands.config_





NOTE: Si los comandos no existen en la lista de comandos, la operación fallará.

.Acerca de esta tarea
* Para obtener información sobre las limitaciones de la operación de división de clones, consulte http://docs.netapp.com/ontap-9/topic/com.netapp.doc.dot-cm-vsmg/home.html["Guía de administración de almacenamiento lógico de ONTAP 9"^] .
* Para ONTAP 9.12.1 y versiones anteriores, los clones creados a partir de las instantáneas de SnapLock Vault como parte de la restauración heredarán el tiempo de vencimiento de SnapLock Vault. El administrador de almacenamiento debe limpiar manualmente los clones después del tiempo de vencimiento de SnapLock .


[role="tabbed-block"]
====
.Interfaz de usuario de SnapCenter
--
.Pasos
. En el panel de navegación izquierdo, haga clic en *Recursos* y luego seleccione el complemento apropiado de la lista.
. En la página Recursos, filtre los recursos de la lista desplegable *Ver* según el tipo de recurso.
+
Los recursos se muestran junto con información como el tipo, el host, los grupos de recursos y políticas asociados y el estado.

. Seleccione el recurso o grupo de recursos.
+
Debe seleccionar un recurso si selecciona un grupo de recursos.

+
Se muestra la página de topología de recursos o grupos de recursos.

. Desde la vista Administrar copias, seleccione *Copias de seguridad* de los sistemas de almacenamiento primario o secundario (duplicado o almacenado en bóveda).
. Seleccione la copia de seguridad de datos de la tabla y luego haga clic enimage:../media/clone_icon.gif["icono de clonación"] .
. En la página Ubicación, realice las siguientes acciones:
+
|===
| Para este campo... | Haz esto... 


 a| 
Host de complementos
 a| 
Seleccione el host en el que se debe montar el clon y se instalará el complemento.



 a| 
SID del clon de destino
 a| 
Ingrese el ID de la instancia de SAP HANA para clonar desde las copias de seguridad existentes.



 a| 
Dirección IP de exportación de NFS
 a| 
Introduzca las direcciones IP o los nombres de host a los que se exportarán los volúmenes clonados.



 a| 
Iniciador iSCSI
 a| 
Introduzca el nombre del iniciador iSCSI del host al que se exportan los LUN.  Esta opción solo está disponible si seleccionó el tipo de recurso LUN.



 a| 
Protocolo
 a| 
Introduzca el protocolo LUN.  Esta opción solo está disponible si seleccionó el tipo de recurso LUN.

|===
+
Si el recurso seleccionado es un LUN y está clonando desde una copia de seguridad secundaria, se enumeran los volúmenes de destino. Un único recurso puede tener varios volúmenes de destino.

+

NOTE: Antes de clonar, debe asegurarse de que el iniciador iSCSI o el FCP estén presentes y configurados e iniciados sesión en hosts alternativos.

. En la página Scripts, realice los siguientes pasos:
+

NOTE: Los scripts se ejecutan en el host del complemento.

+
.. Introduzca los comandos para pre-clonar o post-clonar que deben ejecutarse antes o después de la operación de clonación, respectivamente.
+
*** Comando de preclonación: eliminar bases de datos existentes con el mismo nombre
*** Comando posterior a la clonación: verificar una base de datos o iniciar una base de datos.


.. Introduzca el comando de montaje para montar un sistema de archivos en un host.
+
Comando de montaje para un volumen o qtree en una máquina Linux:

+
Ejemplo para NFS: `mount VSERVER_DATA_IP:%VOLUME_NAME_Clone /mnt`



. En la página de Notificaciones, en la lista desplegable *Preferencias de correo electrónico*, seleccione los escenarios en los que desea enviar los correos electrónicos.
+
También debe especificar las direcciones de correo electrónico del remitente y del destinatario, y el asunto del correo electrónico.

. Revise el resumen y luego haga clic en *Finalizar*.
. Supervise el progreso de la operación haciendo clic en *Monitor* > *Trabajos*.


--
.Cmdlets de PowerShell
--
.Pasos
. Inicie una sesión de conexión con el servidor SnapCenter para un usuario específico mediante el cmdlet Open-SmConnection.
+
[listing]
----
Open-SmConnection  -SMSbaseurl  https:\\snapctr.demo.netapp.com:8146/
----
. Recupere las copias de seguridad para realizar la operación de clonación mediante el cmdlet Get-SmBackup.
+
Este ejemplo muestra que hay dos copias de seguridad disponibles para clonar:

+
[listing]
----
 C:\PS> Get-SmBackup

        BackupId                      BackupName                    BackupTime                    BackupType
        --------                      ----------                    ----------                    ----------
         1                     Payroll Dataset_vise-f6_08... 8/4/2015 11:02:32 AM          Full Backup
         2                     Payroll Dataset_vise-f6_08... 8/4/2015 11:23:17 AM
----
. Inicie una operación de clonación desde una copia de seguridad existente y especifique las direcciones IP de exportación NFS en las que se exportan los volúmenes clonados.
+
Este ejemplo muestra que la copia de seguridad que se va a clonar tiene una dirección NFSExportIPs de 10.232.206.169:

+
[listing]
----
New-SmClone -AppPluginCode hana -BackupName scsccore1_sccore_test_com_hana_H73_scsccore1_06-07-2017_02.54.29.3817 -Resources @{"Host"="scsccore1.sccore.test.com";"Uid"="H73"}  -CloneToInstance shivscc4.sccore.test.com -mountcommand 'mount 10.232.206.169:%hana73data_Clone /hana83data' -preclonecreatecommands '/home/scripts/scpre_clone.sh' -postclonecreatecommands '/home/scripts/scpost_clone.sh'
----
+

NOTE: Si no se especifica NFSExportIPs, el valor predeterminado se exporta al host de destino clonado.

. Verifique que las copias de seguridad se hayan clonado correctamente utilizando el cmdlet Get-SmCloneReport para ver los detalles del trabajo de clonación.
+
Puede ver detalles como el ID del clon, la fecha y hora de inicio, la fecha y hora de finalización.

+
[listing]
----
PS C:\> Get-SmCloneReport -JobId 186

    SmCloneId           : 1
    SmJobId             : 186
    StartDateTime       : 8/3/2015 2:43:02 PM
    EndDateTime         : 8/3/2015 2:44:08 PM
    Duration            : 00:01:06.6760000
    Status              : Completed
    ProtectionGroupName : Draper
    SmProtectionGroupId : 4
    PolicyName          : OnDemand_Clone
    SmPolicyId          : 4
    BackupPolicyName    : OnDemand_Full_Log
    SmBackupPolicyId    : 1
    CloneHostName       : SCSPR0054212005.mycompany.com
    CloneHostId         : 4
    CloneName           : Draper__clone__08-03-2015_14.43.53
    SourceResources     : {Don, Betty, Bobby, Sally}
    ClonedResources     : {Don_DRAPER, Betty_DRAPER, Bobby_DRAPER, Sally_DRAPER}
    SmJobError          :
----


--
====