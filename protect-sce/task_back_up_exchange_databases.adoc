---
permalink: protect-sce/task_back_up_exchange_databases.html 
sidebar: sidebar 
keywords: SnapCenter plug-in for Exchange Server 
summary: Si una base de datos no es parte de ningún grupo de recursos, puede realizar una copia de seguridad de la base de datos o del grupo de disponibilidad de base de datos desde la página Recursos. 
---
= Realizar copias de seguridad de las bases de datos de Exchange
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Si una base de datos no es parte de ningún grupo de recursos, puede realizar una copia de seguridad de la base de datos o del grupo de disponibilidad de base de datos desde la página Recursos.

.Antes de empezar
* Debes haber creado una política de respaldo.
* Debe haber asignado el agregado que está utilizando la operación de respaldo al SVM utilizado por la base de datos.
* Si desea realizar una copia de seguridad de un recurso que tiene una relación SnapMirror con un almacenamiento secundario, la función asignada al usuario de almacenamiento debe incluir el privilegio "`snapmirror all`".  Sin embargo, si está utilizando el rol "`vsadmin`", entonces no se requiere el privilegio "`snapmirror all`".
* Si desea realizar una copia de seguridad de una base de datos o de un grupo de disponibilidad de base de datos que tiene una copia de base de datos activa/pasiva en un almacenamiento NetApp y no NetApp , y ha seleccionado la opción *Hacer copia de seguridad de copias activas* o *Hacer copia de seguridad de copias en servidores que se seleccionarán durante el momento de creación del trabajo de copia de seguridad* en la política, entonces los trabajos de copia de seguridad pasarán al estado de advertencia.  La copia de seguridad será exitosa para la copia de base de datos activa/pasiva en el almacenamiento NetApp y la copia de seguridad fallará para la copia de base de datos activa/pasiva en el almacenamiento que no sea NetApp .
+
|===


| *Mejor práctica:* No ejecute copias de seguridad de bases de datos activas y pasivas al mismo tiempo.  Puede ocurrir una condición de carrera y una de las copias de seguridad podría fallar. 
|===


[role="tabbed-block"]
====
.Interfaz de usuario de SnapCenter
--
.Pasos
. En el panel de navegación izquierdo, haga clic en *Recursos* y, a continuación, seleccione el *complemento de Microsoft Exchange Server* de la lista.
. En la página Recursos, seleccione *Base de datos* o *Grupo de disponibilidad de base de datos* en la lista *Ver*.
+
En la página de Recursos, laimage:../media/not_supported_icon.gif["icono no compatible"] El icono indica que la base de datos está en un almacenamiento que no es de NetApp .

+

NOTE: En un DAG, si una copia de base de datos activa está en un almacenamiento que no es de NetApp y al menos una copia de base de datos pasiva reside en un almacenamiento de NetApp , entonces puede proteger la base de datos.

+
Haga clic en *image:../media/filter_icon.gif["icono de filtro"] * y luego seleccione el nombre del host y el tipo de base de datos para filtrar los recursos.  Luego puedes hacer clic en *image:../media/filter_icon.gif["icono de filtro"] * para cerrar el panel de filtro.

+
** Si desea hacer una copia de seguridad de una base de datos, haga clic en el nombre de la base de datos.
+
... Si se muestra la vista Topología, haga clic en *Proteger*.
... Si se muestra el asistente Base de datos - Proteger recurso, continúe con el Paso 3.


** Si desea realizar una copia de seguridad de un grupo de disponibilidad de base de datos, haga clic en el nombre del grupo de disponibilidad de base de datos.


. Si desea especificar un nombre de instantánea personalizado, en la página Recursos, seleccione la casilla de verificación *Usar formato de nombre personalizado para copia de instantánea* y luego ingrese el formato de nombre personalizado que desee usar para el nombre de la instantánea.
+
Por ejemplo, _customtext_policy_hostname_ o _resource_hostname_.  De forma predeterminada, se agrega una marca de tiempo al nombre de la instantánea.

. En la página Políticas, realice los siguientes pasos:
+
.. Seleccione una o más políticas de la lista desplegable.
+

NOTE: También puedes crear una política haciendo clic en *image:../media/add_policy_from_resourcegroup.gif["Agregar formulario de política al grupo de recursos"] *.

+

NOTE: Si una política contiene la opción *Realizar copias de seguridad en servidores que se seleccionarán en el momento de creación del trabajo de copia de seguridad*, se muestra una opción de selección de servidor para seleccionar uno o más servidores.  La opción de selección de servidor mostrará solo el servidor donde se encuentra la base de datos seleccionada en un almacenamiento NetApp .



+
En la sección Configurar programaciones para políticas seleccionadas, se enumeran las políticas seleccionadas.

+
.. Haga clic en *image:../media/add_policy_from_resourcegroup.gif["Agregar formulario de política al grupo de recursos"] * en la columna Configurar programaciones de la política para la que desea configurar una programación.
.. En la ventana Agregar programaciones para la política _policy_name_, configure la programación y luego haga clic en *Aceptar*.
+
Donde, _policy_name_ es el nombre de la política que ha seleccionado.

+
Los horarios configurados se enumeran en la columna Horarios aplicados.



. En la página de Notificaciones, en la lista desplegable *Preferencias de correo electrónico*, seleccione los escenarios en los que desea enviar los correos electrónicos.
+
También debe especificar las direcciones de correo electrónico del remitente y del destinatario, y el asunto del correo electrónico.  Si desea adjuntar el informe de la operación de respaldo realizada en el recurso, seleccione *Adjuntar informe de trabajo*.

+

NOTE: Para recibir notificaciones por correo electrónico, debe haber especificado los detalles del servidor SMTP mediante la GUI o el comando de PowerShell Set-SmSmtpServer.

. Revise el resumen y luego haga clic en *Finalizar*.
+
Se muestra la página de topología de la base de datos.

. Haga clic en *Hacer copia de seguridad ahora*.
. En la página Copia de seguridad, realice los siguientes pasos:
+
.. Si ha aplicado varias políticas al recurso, en la lista desplegable *Política*, seleccione la política que desea utilizar para la copia de seguridad.
+
Si la política seleccionada para la copia de seguridad a pedido está asociada con una programación de copia de seguridad, las copias de seguridad a pedido se conservarán según la configuración de retención especificada para el tipo de programación.

.. Haga clic en *Copia de seguridad*.


. Supervise el progreso de la copia de seguridad haciendo doble clic en el trabajo en el panel Actividad en la parte inferior de la página para mostrar la página Detalles del trabajo.
+
** En configuraciones de MetroCluster , es posible que SnapCenter no pueda detectar una relación de protección después de una conmutación por error.
+
Para obtener información, consulte: https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Unable_to_detect_SnapMirror_or_SnapVault_relationship_after_MetroCluster_failover["No se puede detectar la relación entre SnapMirror o SnapVault después de una conmutación por error de MetroCluster"^]

** Si está realizando una copia de seguridad de los datos de la aplicación en VMDK y el tamaño del montón de Java para el SnapCenter Plug-in for VMware vSphere no es lo suficientemente grande, la copia de seguridad podría fallar.
+
Para aumentar el tamaño del montón de Java, ubique el archivo de script _/opt/netapp/init_scripts/scvservice_.  En ese script, el comando _do_start method_ inicia el servicio del complemento VMware de SnapCenter .  Actualice ese comando a lo siguiente: _Java -jar -Xmx8192M -Xms4096M_





--
.Cmdlets de PowerShell
--
.Pasos
. Inicie una sesión de conexión con el servidor SnapCenter para un usuario específico mediante el cmdlet Open-SmConnection.
+
[listing]
----
Open-smconnection  -SMSbaseurl  https://snapctr.demo.netapp.com:8146/
----
+
Se muestra la solicitud de nombre de usuario y contraseña.

. Cree una política de respaldo mediante el cmdlet Add-SmPolicy.
+
Este ejemplo crea una nueva política de respaldo con un tipo de respaldo de Exchange de respaldo completo y respaldo de registro:

+
[listing]
----
C:\PS> Add-SmPolicy -PolicyName SCE_w2k12_Full_Log_bkp_Policy -PolicyType Backup -PluginPolicytype SCE -SceBackupType FullBackupAndLogBackup -BackupActiveCopies
----
+
Este ejemplo crea una nueva política de respaldo con una copia de seguridad completa cada hora y un tipo de copia de seguridad de registro de Exchange:

+
[listing]
----
C:\PS> Add-SmPolicy -PolicyName SCE_w2k12_Hourly_Full_Log_bkp_Policy -PolicyType Backup -PluginPolicytype SCE -SceBackupType FullBackupAndLogBackup -BackupActiveCopies -ScheduleType Hourly -RetentionSettings @{'BackupType'='DATA';'ScheduleType'='Hourly';'RetentionCount'='10'}
----
+
Este ejemplo crea una nueva política de respaldo para realizar copias de seguridad únicamente de los registros de Exchange:

+
[listing]
----
Add-SmPolicy -PolicyName SCE_w2k12_Log_bkp_Policy -PolicyType Backup -PluginPolicytype SCE -SceBackupType LogBackup -BackupActiveCopies
----
. Descubra los recursos del host mediante el cmdlet Get-SmResources.
+
Este ejemplo descubre los recursos para el complemento de Microsoft Exchange Server en el host especificado:

+
[listing]
----
C:\PS> Get-SmResources -HostName vise-f6.sddev.mycompany.com -PluginCode SCE
----
. Agregue un nuevo grupo de recursos a SnapCenter mediante el cmdlet Add-SmResourceGroup.
+
Este ejemplo crea un nuevo grupo de recursos de copia de seguridad de la base de datos de Exchange Server con la política y los recursos especificados:

+
[listing]
----
C:\PS> Add-SmResourceGroup -ResourceGroupName SCE_w2k12_bkp_RG -Description 'Backup ResourceGroup with Full and Log backup policy' -PluginCode SCE -Policies SCE_w2k12_Full_bkp_Policy,SCE_w2k12_Full_Log_bkp_Policy,SCE_w2k12_Log_bkp_Policy -Resources @{'Host'='sce-w2k12-exch';'Type'='Exchange Database';'Names'='sce-w2k12-exch.sceqa.com\sce-w2k12-exch_DB_1,sce-w2k12-exch.sceqa.com\sce-w2k12-exch_DB_2'}
----
+
Este ejemplo crea un nuevo grupo de recursos de respaldo del grupo de disponibilidad de base de datos (DAG) de Exchange con la política y los recursos especificados:

+
[listing]
----
Add-SmResourceGroup -ResourceGroupName SCE_w2k12_bkp_RG -Description 'Backup ResourceGroup with Full and Log backup policy' -PluginCode SCE -Policies SCE_w2k12_Full_bkp_Policy,SCE_w2k12_Full_Log_bkp_Policy,SCE_w2k12_Log_bkp_Policy -Resources @{"Host"="DAGSCE0102";"Type"="Database Availability Group";"Names"="DAGSCE0102"}
----
. Inicie un nuevo trabajo de respaldo mediante el cmdlet New-SmBackup.
+
[listing]
----
C:\PS> New-SmBackup -ResourceGroupName SCE_w2k12_bkp_RG -Policy SCE_w2k12_Full_Log_bkp_Policy
----
+
Este ejemplo crea una nueva copia de seguridad en un almacenamiento secundario:

+
[listing]
----
New-SMBackup -DatasetName ResourceGroup1 -Policy Secondary_Backup_Policy4
----
. Vea el estado del trabajo de respaldo mediante el cmdlet Get-SmBackupReport.
+
Este ejemplo muestra un informe de resumen de trabajos de todos los trabajos que se ejecutaron en la fecha especificada:

+
[listing]
----
C:\PS> Get-SmJobSummaryReport -Date ?1/27/2018?
----
+
Este ejemplo muestra un informe de resumen de trabajo para un ID de trabajo específico:

+
[listing]
----
C:\PS> Get-SmJobSummaryReport -JobId 168
----


La información sobre los parámetros que se pueden utilizar con el cmdlet y sus descripciones se puede obtener ejecutando _Get-Help command_name_.  Alternativamente, véase https://docs.netapp.com/us-en/snapcenter-cmdlets/index.html["Guía de referencia de cmdlets del software SnapCenter"^] .

--
====