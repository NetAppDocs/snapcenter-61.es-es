---
permalink: protect-db2/back-up-db2-databases.html 
sidebar: sidebar 
keywords: SnapCenter Plug-in for IBM Db2 
summary: Realizar una copia de seguridad de una base de datos incluye establecer una conexión con el servidor SnapCenter , agregar recursos, agregar una política, crear un grupo de recursos de copia de seguridad y realizar una copia de seguridad. 
---
= Realizar copias de seguridad de bases de datos Db2
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Realizar una copia de seguridad de una base de datos incluye establecer una conexión con el servidor SnapCenter , agregar recursos, agregar una política, crear un grupo de recursos de copia de seguridad y realizar una copia de seguridad.

.Antes de empezar
* Debes haber creado una política de respaldo.
* Si desea realizar una copia de seguridad de un recurso que tiene una relación SnapMirror con un almacenamiento secundario, la función de ONTAP asignada al usuario de almacenamiento debe incluir el privilegio "`snapmirror all`".  Sin embargo, si está utilizando el rol "`vsadmin`", entonces no se requiere el privilegio "`snapmirror all`".
* Para la operación de copia de seguridad basada en instantáneas, asegúrese de que todas las bases de datos de los inquilinos sean válidas y activas.
* Para los comandos previos y posteriores para operaciones de inactividad, instantánea y desactivación del modo inactivo, debe verificar si los comandos existen en la lista de comandos disponible en el host del complemento desde las siguientes rutas:
+
** Ubicación predeterminada en el host de Windows: _C:\Archivos de programa\ NetApp\ SnapCenter\Snapcenter Plug-in Creator\etc\allowed_commands.config_
** Ubicación predeterminada en el host Linux: _/opt/ NetApp/snapcenter/scc/etc/allowed_commands.config_





NOTE: Si los comandos no existen en la lista de comandos, la operación fallará.

[role="tabbed-block"]
====
.Interfaz de usuario de SnapCenter
--
.Pasos
. En el panel de navegación izquierdo, seleccione *Recursos* y luego seleccione el complemento apropiado de la lista.
. En la página Recursos, filtre los recursos de la lista desplegable *Ver* según el tipo de recurso.
+
Seleccionarimage:../media/filter_icon.gif["icono de filtro"] y luego seleccione el nombre del host y el tipo de recurso para filtrar los recursos.  Luego puedes seleccionarimage:../media/filter_icon.gif["icono de filtro"] para cerrar el panel de filtro.

. Seleccione el recurso que desea respaldar.
. En la página Recursos, seleccione *Usar formato de nombre personalizado para copia de instantánea* y luego ingrese el formato de nombre personalizado que desee usar para el nombre de la instantánea.
+
Por ejemplo, _customtext_policy_hostname_ o _resource_hostname_.  De forma predeterminada, se agrega una marca de tiempo al nombre de la instantánea.

. En la página Configuración de la aplicación, haga lo siguiente:
+
** Seleccione la flecha *Copias de seguridad* para configurar opciones de copia de seguridad adicionales:
+
Habilite la copia de seguridad del grupo de consistencia, si es necesario, y realice las siguientes tareas:

+
|===
| Para este campo... | Haz esto... 


 a| 
Dedique tiempo a esperar hasta que se complete la operación "Instantánea del grupo de consistencia"
 a| 
Seleccione *Urgente*, *Medio* o *Relajado* para especificar el tiempo de espera para que finalice la operación de instantánea.  Urgente = 5 segundos, Medio = 7 segundos y Relajado = 20 segundos.



 a| 
Deshabilitar la sincronización de WAFL
 a| 
Seleccione esta opción para evitar forzar un punto de consistencia WAFL .

|===
** Seleccione la flecha *Scripts* para ejecutar comandos previos y posteriores para operaciones de inactividad, instantánea y desactivación del modo inactivo.
+
También puede ejecutar comandos previos antes de salir de la operación de copia de seguridad.  Los prescriptos y posscriptos se ejecutan en el servidor SnapCenter .

** Seleccione la flecha **Configuraciones personalizadas** y luego ingrese los pares de valores personalizados necesarios para todos los trabajos que utilicen este recurso.
** Seleccione la flecha *Herramienta Copiar Instantánea* para seleccionar la herramienta para crear Instantáneas:
+
|===
| Si quieres... | Entonces... 


 a| 
SnapCenter para crear una instantánea a nivel de almacenamiento
 a| 
Seleccione * SnapCenter sin consistencia del sistema de archivos*.



 a| 
SnapCenter para usar el complemento para Windows para poner el sistema de archivos en un estado consistente y luego crear una instantánea
 a| 
Seleccione * SnapCenter con consistencia del sistema de archivos*.



 a| 
Para ingresar el comando para crear una instantánea
 a| 
Seleccione *Otro* y luego ingrese el comando para crear una instantánea.

|===
+
image:../media/application_settings.gif["configuración de la aplicación"]



. En la página Políticas, realice los siguientes pasos:
+
.. Seleccione una o más políticas de la lista desplegable.
+

NOTE: También puedes crear una política haciendo clic en *image:../media/add_policy_from_resourcegroup.gif[""] *.

+
En la sección Configurar programaciones para políticas seleccionadas, se enumeran las políticas seleccionadas.

.. Seleccionar *image:../media/add_policy_from_resourcegroup.gif[""] * en la columna Configurar programaciones de la política para la que desea configurar una programación.
.. En el cuadro de diálogo Agregar programaciones para la política _policy_name_, configure la programación y luego seleccione *Aceptar*.
+
_policy_name_ es el nombre de la política que usted seleccionó.

+
Los horarios configurados se enumeran en la columna Horarios aplicados.



. En la página de Notificaciones, en la lista desplegable *Preferencias de correo electrónico*, seleccione los escenarios en los que desea enviar los correos electrónicos.
+
También debe especificar las direcciones de correo electrónico del remitente y del destinatario, y el asunto del correo electrónico.  El SMTP también debe configurarse en *Configuración* > *Configuración global*.

. Revise el resumen y luego seleccione *Finalizar*.
+
Se muestra la página de topología de recursos.

. Seleccione *Hacer copia de seguridad ahora*.
. En la página Copia de seguridad, realice los siguientes pasos:
+
.. Si aplicó varias políticas al recurso, en la lista desplegable *Política*, seleccione la política que desea utilizar para la copia de seguridad.
+
Si la política seleccionada para la copia de seguridad a pedido está asociada con una programación de copia de seguridad, las copias de seguridad a pedido se conservarán según la configuración de retención especificada para el tipo de programación.

.. Seleccione *Copia de seguridad*.


. Supervise el progreso de la operación haciendo clic en *Monitor* > *Trabajos*.
+
** En configuraciones de MetroCluster , es posible que SnapCenter no pueda detectar una relación de protección después de una conmutación por error.
+
Para obtener información, consulte: https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Unable_to_detect_SnapMirror_or_SnapVault_relationship_after_MetroCluster_failover["No se puede detectar la relación entre SnapMirror o SnapVault después de una conmutación por error de MetroCluster"^]





--
.Cmdlets de PowerShell
--
.Pasos
. Inicie una sesión de conexión con el servidor SnapCenter para un usuario específico mediante el cmdlet Open-SmConnection.
+
[listing]
----
PS C:\> Open-SmConnection
----
+
Se muestra la solicitud de nombre de usuario y contraseña.

. Agregue recursos manuales mediante el cmdlet Add-SmResources.
+
Este ejemplo muestra cómo agregar una instancia de IBM Db2:

+
[listing]
----
PS C:\> Add-SmResource -HostName 10.32.212.13 -PluginCode DB2 -ResourceType Instance -ResourceName db2inst1 -StorageFootPrint (@{"VolumeName"="windb201_data01";"LUNName"="windb201_data01";"StorageSystem"="scsnfssvm"}) -MountPoints "D:\"
----
+
Para la base de datos Db2:

+
[listing]
----
PS C:\> Add-SmResource -HostName 10.32.212.13 -PluginCode DB2 -ResourceType Database -ResourceName SALESDB -StorageFootPrint (@{"VolumeName"="windb201_data01";"LUNName"="windb201_data01";"StorageSystem"="scsnfssvm"}) -MountPoints "D:\" -Instance DB2
----
. Cree una política de respaldo mediante el cmdlet Add-SmPolicy.
. Proteja el recurso o agregue un nuevo grupo de recursos a SnapCenter mediante el cmdlet Add-SmResourceGroup.
. Inicie un nuevo trabajo de respaldo mediante el cmdlet New-SmBackup.
+
Este ejemplo muestra cómo realizar una copia de seguridad de un grupo de recursos:

+
[listing]
----
C:\PS> New-SMBackup -ResourceGroupName 'ResourceGroup_with_Db2_Resources' -Policy db2_policy1
----
+
Este ejemplo realiza una copia de seguridad de una instancia de Db2:

+
[listing]
----
C:\PS> New-SMBackup -Resources @{"Host"="10.32.212.13";"Uid"="DB2INST1";"PluginName"="DB2"} -Policy db2_policy
----
+
Este ejemplo realiza una copia de seguridad de una base de datos Db2:

+
[listing]
----
C:\PS> New-SMBackup -Resources @{"Host"="10.32.212.13";"Uid"="DB2INST1\WINARCDB";"PluginName"="DB2"} -Policy db2_policy
----
. Supervise el estado del trabajo (en ejecución, completado o fallido) mediante el cmdlet Get-smJobSummaryReport.
+
[listing]
----
PS C:\> Get-SmJobSummaryReport -JobId 467

SmJobId            : 467
JobCreatedDateTime :
JobStartDateTime   : 27-Jun-24 01:40:09
JobEndDateTime     : 27-Jun-24 01:41:15
JobDuration        : 00:01:06.7013330
JobName            : Backup of Resource Group 'SCDB201WIN_RAVIR1_OPENLAB_NETAPP_LOCAL_DB2_DB2_WINCIR' with policy 'snapshot-based-db2'
JobDescription     :
Status             : Completed
IsScheduled        : False
JobError           :
JobType            : Backup
PolicyName         : db2_policy
JobResultData      :
----
. Supervise los detalles del trabajo de respaldo, como la identificación y el nombre del respaldo, para realizar una operación de restauración o clonación mediante el cmdlet Get-SmBackupReport.
+
[listing]
----
PS C:\> Get-SmBackupReport -JobId 467

BackedUpObjects           : {WINCIR}
FailedObjects             : {}
IsScheduled               : False
HasMetadata               : False
SmBackupId                : 84
SmJobId                   : 467
StartDateTime             : 27-Jun-24 01:40:09
EndDateTime               : 27-Jun-24 01:41:15
Duration                  : 00:01:06.7013330
CreatedDateTime           : 27-Jun-24 18:39:45
Status                    : Completed
ProtectionGroupName       : HOSTFQDN_DB2_DB2_WINCIR
SmProtectionGroupId       : 23
PolicyName                : db2_policy
SmPolicyId                : 13
BackupName                : HOSTFQDN _DB2_DB2_WINCIR_HOST_06-27-2024_01.40.09.7397
VerificationStatus        : NotApplicable
VerificationStatuses      :
SmJobError                :
BackupType                : SCC_BACKUP
CatalogingStatus          : NotApplicable
CatalogingStatuses        :
ReportDataCreatedDateTime :
PluginCode                : SCC
PluginName                : DB2
PluginDisplayName         : IBM DB2
JobTypeId                 :
JobHost                   : HOSTFQDN
----


La información sobre los parámetros que se pueden utilizar con el cmdlet y sus descripciones se puede obtener ejecutando _Get-Help command_name_. Alternativamente, también puede consultar la https://docs.netapp.com/us-en/snapcenter-cmdlets/index.html["Guía de referencia de cmdlets del software SnapCenter"^] .

--
====